#!/bin/bash 
if [[ $# < 1 || $1 == "--help" ]]
then
echo "Usage: GenerateStatisticsFromLabels.sh AtlasName"
echo "       Generates a variety of statistics for each label in the atlas"
echo "       Available Atlases are;"
echo "         `ls -1 @OpenAtlas_SOURCE_DIR@/Atlases`"
exit 1
fi

Prog=GenerateStatisticsFromLabels
OpenAtlasHome=@OpenAtlas_SOURCE_DIR@
Atlas=$1

if [ ! -d $OpenAtlasHome/Atlases/$Atlas ] ; then
  echo "The atlas $Atlas does not exist."
  echo "Available atlases are:"
  echo "`ls -1 @OpenAtlas_SOURCE_DIR@/Atlases`"
  exit 1
fi

# Make the directory if it does not exist
if [ ! -d $OpenAtlasHome/Atlases/$Atlas/Statistics ] ; then
  mkdir $OpenAtlasHome/Atlases/$Atlas/Statistics
fi
pushd $OpenAtlasHome/Atlases/$Atlas/Statistics

AppDir=""
if [ `uname` == "Darwin" ]; then AppDir=$Prog.app/Contents/MacOS/ ; fi

echo "$Prog: Statistics files will be written to $OpenAtlasHome/Atlases/$Atlas/Statistics"
@OpenAtlas_BINARY_DIR@/$AppDir/$Prog $OpenAtlasHome/Atlases/$Atlas/Atlas/${Atlas}Volume.nrrd $OpenAtlasHome/Atlases/$Atlas/Atlas/${Atlas}Labels.nrrd $OpenAtlasHome/Atlases/$Atlas/Atlas/${Atlas}Colors.ctbl
echo "$Prog: Statistics files have been written to $OpenAtlasHome/Atlases/$Atlas/Statistics"

popd
