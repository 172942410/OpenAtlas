#!/bin/bash 
if [[ $# < 1 || $1 == "--help" ]]
then
echo "Usage: GenerateCubesFromLabels.sh AtlasName"
echo "       Generates cube models( .vtk) for each label in the atlas"
echo "       Available Atlases are;"
echo "         `ls -1 @OpenAtlas_SOURCE_DIR@/Atlases`"
exit 1
fi

Prog=GenerateCubesFromLabels
Atlas=$1
OpenAtlasHome=@OpenAtlas_SOURCE_DIR@

# Make the directory if it does not exist
if [ ! -d $OpenAtlasHome/Atlases/$Atlas/Models/VTK ] ; then
  mkdir -p $OpenAtlasHome/Atlases/$Atlas/Models/VTK
fi
pushd $OpenAtlasHome/Atlases/$Atlas/Models/VTK

AppDir=""
if [ `uname` == "Darwin" ]; then AppDir=$Prog.app/Contents/MacOS/ ; fi

echo "$Prog: Cube models will be written to $OpenAtlasHome/Atlases/$Atlas/Models/VTK"
@OpenAtlas_BINARY_DIR@/$AppDir/$Prog $OpenAtlasHome/Atlases/$Atlas/Atlas/${Atlas}Labels.nrrd 1 5000 $OpenAtlasHome/Atlases/$Atlas/Atlas/${Atlas}Colors.ctbl
echo "$Prog: Cube models have been written to $OpenAtlasHome/Atlases/$Atlas/Models/VTK"
popd
