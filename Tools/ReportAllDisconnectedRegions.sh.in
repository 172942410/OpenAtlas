#!/bin/bash 
if [[ $# < 1 || $1 == "--help" ]]
then
echo "Usage: ReportAllDisconnectedRegions AtlasName"
echo "       Reports all models with more than one connected region."
exit 1
fi

Prog=GetAtlasAttribute
AppDir=""
if [ `uname` == "Darwin" ]; then AppDir=$Prog.app/Contents/MacOS/ ; fi
Atlas=`@OpenAtlas_BINARY_DIR@/$AppDir/$Prog $1 AtlasName`
FiducialDirectory=`@OpenAtlas_BINARY_DIR@/$AppDir/$Prog $1 FiducialsDirectory`
VTKDirectory=`@OpenAtlas_BINARY_DIR@/$AppDir/$Prog $1 VTKDirectory`

rm $FiducialDirectory/*.mrml
rm $FiducialDirectory/*.csv
pushd $VTKDirectory

Prog=ReportDisconnectedRegions
AppDir=""
if [ `uname` == "Darwin" ]; then AppDir=$Prog.app/Contents/MacOS/ ; fi

status=0
files=`ls *.vtk`
for f in $files; do
  @OpenAtlas_BINARY_DIR@/$AppDir/$Prog $f $FiducialDirectory
  let status=$status+$?
done
echo $status atlas parts have disconnected regions
popd
exit $status



